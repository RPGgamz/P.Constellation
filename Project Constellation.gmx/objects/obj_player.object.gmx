<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_mc_idle_up</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>obj_lifeform</parentName>
  <maskName>spr_damage</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Init. variables
randomize();

xaxis = 0;
yaxis = 0;
x_vel = 0;
y_vel = 0;
angle = 270;
turnrate = 8;


normalspd = 1;
spd = normalspd;
runspd = 3;

stamina_max = 100;
stamina = stamina_max;
hp_max = 150;
hp = hp_max;
mana_max = 80;
mana = mana_max;

dmg = 3;

state = scr_playerstate_move;

moveset = 0; //0 = idle, 1 = move, 2 = run, 3 = attack, 4 = spells
dir = 2;
attack_dir = 0;
alarm[9] = 60;

combo = false;
dash_combo = false;


heal = false;


if !(instance_exists(obj_control)) {
    instance_create(0, 0, obj_control);
    show_debug_message("control created.");
} else {
    x = obj_control.x_last;
    y = obj_control.y_last;
    show_debug_message("last loaded.");
}
instance_create(x, y, obj_camera);
var day_night_cycle = instance_create(0, 0, obj_cycle);
day_night_cycle.alarm[0] = day_night_cycle.day_time;
day_night_cycle.image_alpha = 0;
day_night_cycle.alarm[3] = random_range(5300, 10000);
day_night_cycle.alarm[5] = 1

//Idle
animation[0, 0] = spr_mc_idle_right;
animation[0, 1] = spr_mc_idle_rightup;
animation[0, 2] = spr_mc_idle_up;
animation[0, 3] = spr_mc_idle_upleft;
animation[0, 4] = spr_mc_idle_left;
animation[0, 5] = spr_mc_idle_leftdown;
animation[0, 6] = spr_mc_idle_down;
animation[0, 7] = spr_mc_idle_downright;
//Move
animation[1, 0] = spr_mc_walk_right;
animation[1, 1] = spr_mc_walk_rightup;
animation[1, 2] = spr_mc_walk_up;
animation[1, 3] = spr_mc_walk_upleft;
animation[1, 4] = spr_mc_walk_left;
animation[1, 5] = spr_mc_walk_leftdown;
animation[1, 6] = spr_mc_walk_down;
animation[1, 7] = spr_mc_walk_downright;
//Run
animation[2, 0] = spr_player_r_right;
animation[2, 1] = spr_player_r_rightup;
animation[2, 2] = spr_player_r_up;
animation[2, 3] = spr_player_r_upleft;
animation[2, 4] = spr_player_r_left;
animation[2, 5] = spr_player_r_leftdown;
animation[2, 6] = spr_player_r_down;
animation[2, 7] = spr_player_r_downright;
//Attack
animation[3, 0] = spr_player_a_right;
animation[3, 1] = spr_player_a_rightup;
animation[3, 2] = spr_player_a_up;
animation[3, 3] = spr_player_a_upleft;
animation[3, 4] = spr_player_a_left;
animation[3, 5] = spr_player_a_leftdown;
animation[3, 6] = spr_player_a_down;
animation[3, 7] = spr_player_a_downright;
//Spells
animation[4, 0] = spr_player_s_right;
animation[4, 1] = spr_player_s_rightup;
animation[4, 2] = spr_player_s_up;
animation[4, 3] = spr_player_s_upleft;
animation[4, 4] = spr_player_s_left;
animation[4, 5] = spr_player_s_leftdown;
animation[4, 6] = spr_player_s_down;
animation[4, 7] = spr_player_s_downright;



</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Initializing the particle emitter
ps = part_system_create();
emitter = part_emitter_create(ps);
ps_desert = part_system_create();
emitter_desert = part_emitter_create(ps_desert);
scr_particle_heal_initialize();
scr_particle_desert_initialize();

part_system_depth(ps_desert, -7000);
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>c_hp = make_color_rgb(154,39,39);
c_stamina = make_color_rgb(80,114,104);
c_hydro = make_color_rgb(142,205,225);
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///hydro-mechanic init.
hydro = 600;
hydromax = hydro;
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Monster Count

monster_count_1 = 0;
monster_count_2 = 0;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[6] Dash alarm (back to movestate)
state = scr_playerstate_move;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[5] Remove buff
dmg -= 2;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[4] Use magic
alarm[5] = 300;
dmg += 2;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[3] (empty: combo attack)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[2] (empty: ???)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[1] (emtpy: efter stamina = 0 går der x frames før man kan bruge det)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Alarm[0] (empty: bruges til stamina regen)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///State, physics and gamepad_input
scr_get_gamepad_input(0);
script_execute(state);

scr_physics();

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Particle emitter!
part_emitter_region(ps, emitter, x-16, x+16, y-16, y+16, ps_shape_ellipse, ps_distr_linear);
part_emitter_region(ps_desert, emitter_desert, x-500, x-300, y-600, y+600, ps_shape_rectangle, ps_distr_linear);

//Create the particles inside the emitter
if (heal) {
    part_emitter_stream(ps, emitter, global.pt_heal, 1);
} else {
    part_emitter_clear(ps, emitter);
}
if (obj_cycle.sandstorm == true) {
    part_emitter_stream(ps_desert, emitter_desert, global.pt_desert, 4);
} else {
    part_emitter_clear(ps_desert, emitter_desert);
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Animation

var temp_angle = point_direction(0, 0, xaxis, yaxis)

if (temp_angle &gt; 0 &amp;&amp; temp_angle &lt; 22.5) or (temp_angle &lt; 360 &amp;&amp; temp_angle &gt; 337.5) {
    dir = 0;
}
if (temp_angle &gt; 22.5 &amp;&amp; temp_angle &lt; 67.5) {
    dir = 1;
}
if (temp_angle &gt; 67.5 &amp;&amp; temp_angle &lt; 112.5) {
    dir = 2;
}
if (temp_angle &gt; 112.5 &amp;&amp; temp_angle &lt; 157.5) {
    dir = 3;
}
if (temp_angle &gt; 157.5 &amp;&amp; temp_angle &lt; 202.5) {
    dir = 4;
}
if (temp_angle &gt; 202.5 &amp;&amp; temp_angle &lt; 247.5) {
    dir = 5;
}
if (temp_angle &gt; 247.5 &amp;&amp; temp_angle &lt; 292.5) {
    dir = 6;
}
if (temp_angle &gt; 292.5 &amp;&amp; temp_angle &lt; 337.5) {
    dir = 7;
}

if (state == scr_playerstate_move) {
    sprite_index = animation[moveset, dir];
} else if (gamepad_button_check_pressed(0, gp_shoulderr)) {
    sprite_index = animation[moveset, attack_dir]; //HEY der er lige nu ét fram delay (pga. state transition) !!!
}
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Hydroloss!
var hydroloss = .04;

if (distance_to_object(obj_oasis) &lt; 16) {
    near_oasis = true;
} else {
    near_oasis = false;
}

if (obj_cycle.sandstorm) {
    hydroloss += .06;
}
if !(near_oasis) {
    hydro -= hydroloss;
} else {
    if (hydro &lt; hydromax) {
        hydro += 1;
        if (hydro &gt; hydromax) {
            hydro = hydromax;
        }
    }
}

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Death
if (hp &lt;= 0 or hydro &lt;= 0) {
    instance_destroy();
}

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="7">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Move to move_state after attack animation (or combo!)
if (sprite_index == animation[3, attack_dir]) {
    if (stamina &gt;= 10) &amp;&amp; (combo) {
        state = scr_playerstate_attacking;
        moveset = 3;
        image_index = 0;
        image_speed = 18/60;
        attack_dir = dir;
        alarm[0] = 72; //how long before stamina regen (look at run above)
        alarm[3] = 12;
        
        combo = false;
    } else if (stamina &gt;= 20) &amp;&amp; (dash_combo) {
        state = scr_playerstate_dash;
        alarm[0] = 72;
        alarm[6] = 10;
        stamina -= 20;
        dash_combo = false;
    } else {
        state = scr_playerstate_move;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Particle systemet getter destroyed
part_system_destroy(ps);
part_system_destroy(ps_desert);
part_type_destroy(global.pt_heal);
part_type_destroy(global.pt_desert);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="64">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Draw stats
var distance = 10;

draw_set_font(font_8courier);

if (hp &gt; 0) {
    draw_set_color(c_hp);
    draw_rectangle(10, 10, 10+hp*2, 18, false);
}
if (stamina &gt; 0) {
    draw_set_color(c_stamina);
    draw_rectangle(10, 10+distance*2, 10+stamina*2, 18+distance*2, false);
}
//outlines
draw_set_color(c_black);
draw_rectangle(9, 9+distance*2, 11+stamina_max*2, 19+distance*2, true);
draw_rectangle(9, 9, 11+hp_max*2, 19, true);
draw_rectangle(9, 701, 23, 700-(hydromax+1), true);
draw_rectangle(1171, 771, 1039, 751, true);
draw_rectangle(1171, 771-30, 1039, 751-30, true);

//draw_text(10, 65, alarm[0]);
//draw_text(50, 65, alarm[1]);
//draw_text(90, 65, alarm[3]);
//draw_text(10, 110, "DMG " + string(dmg));

//hydrated
draw_set_color(c_hydro);
draw_rectangle(10, 700, 22, 700-hydro, false);

//monster counter
draw_set_halign(fa_right);
draw_set_valign(fa_bottom);
draw_set_color(c_gray);
draw_rectangle(1170, 770, 1040, 752, false);
draw_rectangle(1170, 770-30, 1040, 752-30, false);
draw_set_color(c_white);
draw_set_font(font_8courier);
draw_text(1170, 769, string(monster_count_1));
draw_text(1170, 769-30, string(monster_count_2));


draw_set_halign(fa_left);
draw_set_valign(fa_top);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Draw turnrate thing (and self)
//draw_sprite_ext(spr_temp_streg,0,x,y,1,1,angle,c_white,1)
draw_self();

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
